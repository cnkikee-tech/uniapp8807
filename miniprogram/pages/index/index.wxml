<!--pages/index/index.wxml-->
<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <view class="search-input-wrapper">
      <input 
        class="search-input" 
        placeholder="æœç´¢å§“åã€å…¬å¸ã€èŒåŠ¡..." 
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        bindconfirm="onSearchConfirm"
      />
      <view class="search-icon" bindtap="onSearch">
        <text class="iconfont icon-search"></text>
      </view>
    </view>
  </view>

  <!-- åç‰‡åˆ—è¡¨ -->
  <scroll-view 
    scroll-y 
    class="card-list" 
    refresher-enabled="{{true}}"
    refresher-triggered="{{isRefreshing}}"
    bindrefresherrefresh="onRefresh"
    bindscrolltolower="onLoadMore"
  >
    <view wx:if="{{cards.length === 0 && !isLoading}}" class="empty-state">
      <image class="empty-icon" src="/images/empty.png" mode="aspectFit"></image>
      <text class="empty-text">æš‚æ— åç‰‡æ•°æ®</text>
    </view>
    
    <view wx:else class="card-grid">
      <view 
        class="card-item" 
        wx:for="{{cards}}" 
        wx:key="id"
        bindtap="onCardTap"
        data-id="{{item.id}}"
      >
        <view class="card-content">
          <view class="card-header">
            <image 
              class="card-avatar" 
              src="{{item.avatar || '/images/default-avatar.png'}}" 
              mode="aspectFill"
            ></image>
            <view class="card-info">
              <text class="card-name">{{item.name}}</text>
              <text class="card-position">{{item.position || 'æš‚æ— èŒåŠ¡'}}</text>
            </view>
          </view>
          <view class="card-body">
            <text class="card-company">{{item.company || 'æš‚æ— å…¬å¸'}}</text>
            <view class="card-contact">
              <text class="card-phone">ğŸ“ {{item.phone}}</text>
              <text class="card-email">ğŸ“§ {{item.email || 'æš‚æ— é‚®ç®±'}}</text>
            </view>
          </view>
          <view class="card-footer">
            <text class="card-views">æµè§ˆ {{item.view_count}}</text>
            <text class="card-date">{{item.created_at}}</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- åŠ è½½æ›´å¤šæç¤º -->
    <view wx:if="{{isLoadingMore}}" class="load-more">
      <text>åŠ è½½ä¸­...</text>
    </view>
    
    <view wx:if="{{!hasMore && cards.length > 0}}" class="no-more">
      <text>æ²¡æœ‰æ›´å¤šäº†</text>
    </view>
  </scroll-view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{isLoading}}" class="loading">
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>